{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    const formElem = document.querySelector('.search-form');\n    const galleryEl = document.querySelector('#gallery-o');\n    const loaderElem = document.querySelector('.loader');\n    const loadMoreBtn = document.querySelector('.load-more-btn');\n    const loadMoreLoader = document.querySelector('.load-more-loader');\n    const endOfCollectionMsg = document.querySelector('.end-of-collection');\n\n    hideLoader();\n\n    const lightbox = new SimpleLightbox('.gallery-o a', {\n        captionDelay: 250,\n    });\n\n    formElem.addEventListener('submit', onSubmit);\n\n    let currentPage = 1;\n    let currentSearch = '';\n\n    async function onSubmit(e) {\n        e.preventDefault();\n        showLoader();\n        currentPage = 1;\n        currentSearch = formElem.querySelector('.input-search').value;\n\n        try {\n            const data = await getPhotoBySearch(currentSearch, currentPage);\n            renderImages(data.hits);\n            currentPage++;\n        } catch (error) {\n            renderError(error);\n        } finally {\n            hideLoader();\n        }\n    }\n\n    async function getPhotoBySearch(searchValue, page) {\n        const BASE_URL = 'https://pixabay.com/api/';\n        const KEY = '42296578-21d0e9ca438ad812aa67579cd';\n        const Query = `?key=${KEY}&q=${searchValue}&page=${page}`;\n        const params = '&image_type=photo&orientation=horizontal&safesearch=true&per_page=15';\n        const url = BASE_URL + Query + params;\n        \n        try {\n            const response = await axios.get(url);\n            const data = response.data;\n        \n        if (!data || data.total === 0 || !data.hits || data.hits.length === 0) {\n            throw new Error('No images found');\n        }\n\n        const totalPages = Math.ceil(data.totalHits / 15);\n        if (page >= totalPages) {\n            hideLoadMoreButton();\n            showEndOfCollectionMessage();\n        } else {\n            showLoadMoreButton();\n            hideEndOfCollectionMessage();\n        }\n\n        return data;\n    } catch (error) {\n        throw new Error(error.response ? error.response.data.message : error.message);\n    }\n}\n\n    function hideLoadMoreButton() {\n    loadMoreBtn.hidden = true;\n}\n\nfunction showLoadMoreButton() {\n    loadMoreBtn.hidden = false;\n}\n\nfunction showEndOfCollectionMessage() {\n    endOfCollectionMsg.style.display = 'block';\n}\n\nfunction hideEndOfCollectionMessage() {\n    endOfCollectionMsg.style.display = 'none';\n}\n\n    \n    function renderImages(array) {\n    const markup = array\n        .map(\n        ({\n            largeImageURL,\n            webformatURL,\n            tags,\n            likes,\n            views,\n            comments,\n            downloads,\n        }) => {\n            return `\n        <div class=\"gallery\">\n            <a href=\"${largeImageURL}\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" title=\"${tags}\" width=\"400\" height=\"240\" />\n            <ul class=\"info-cards-container\">\n                <li class=\"info-cards-elements\">likes<span>${likes}</span></li>\n                <li class=\"info-cards-elements\">views<span>${views}</span></li>\n                <li class=\"info-cards-elements\">comments<span>${comments}</span></li>\n                <li class=\"info-cards-elements\">downloads<span>${downloads}</span></li>\n            </ul>\n            </a>\n        </div>\n        `;\n        }\n        )\n        .join('');\n\n    galleryEl.innerHTML = markup;\n    lightbox.refresh();\n    showLoadMoreButton();\n    }\n\n    function renderError(error) {\n    galleryEl.innerHTML = '';\n    iziToast.show({\n        message: `âŒ \"${error.message}\". Please try again!`,\n        color: 'red',\n        position: 'topRight',\n        maxWidth: '400px',\n    });\n    }\n\n    function showLoader() {\n    loaderElem.style.display = 'block';\n    }\n\n    function hideLoader() {\n    loaderElem.style.display = 'none';\n    }\n\n    function showLoadMoreButton() {\n        toggleLoadMoreButtonVisibility(true);\n    }\n\n    loadMoreBtn.addEventListener('click', async () => {\n        showLoadMoreLoader();\n\n    try {\n        const data = await getPhotoBySearch(currentSearch, currentPage + 1);\n        \n        if (data.totalHits === 0) {\n            hideLoadMoreButton();\n            showEndOfCollectionMessage();\n        } else {\n            appendImages(data.hits);\n            currentPage++;\n        }\n    } catch (error) {\n        renderError(error);\n    } finally {\n        hideLoadMoreLoader();\n    }\n});\n\n    function appendImages(array) {\n        const markup = array\n            .map(({ largeImageURL, webformatURL, tags, likes, views, comments, downloads }) => {\n                return `\n                    <div class=\"gallery\">\n                        <a href=\"${largeImageURL}\">\n                            <img src=\"${webformatURL}\" alt=\"${tags}\" title=\"${tags}\" width=\"380\" height=\"220\" />\n                            <ul class=\"info-cards-container\">\n                                <li class=\"info-cards-elements\">likes<span>${likes}</span></li>\n                                <li class=\"info-cards-elements\">views<span>${views}</span></li>\n                                <li class=\"info-cards-elements\">comments<span>${comments}</span></li>\n                                <li class=\"info-cards-elements\">downloads<span>${downloads}</span></li>\n                            </ul>\n                        </a>\n                    </div>\n                `;\n            })\n            .join('');\n\n        galleryEl.insertAdjacentHTML('beforeend', markup);\n        lightbox.refresh();\n\n        hideLoadMoreLoader();\n    }\n\n    function toggleLoadMoreButtonVisibility(show) {\n        loadMoreBtn.hidden = !show;\n    }\n\n    function showLoadMoreLoader() {\n        toggleLoadMoreLoaderVisibility(true);\n    }\n\n    function hideLoadMoreLoader() {\n        toggleLoadMoreLoaderVisibility(false);\n    }\n\n    function toggleLoadMoreLoaderVisibility(show) {\n        loadMoreLoader.style.display = show ? 'block' : 'none';\n    }\n\n    function showEndOfCollectionMessage() {\n        endOfCollectionMsg.style.display = 'block';\n    }\n\n    function hideEndOfCollectionMessage() {\n        endOfCollectionMsg.style.display = 'none';\n    }\n});\n"],"names":["formElem","galleryEl","loaderElem","loadMoreBtn","loadMoreLoader","endOfCollectionMsg","hideLoader","lightbox","SimpleLightbox","onSubmit","currentPage","currentSearch","showLoader","data","getPhotoBySearch","renderImages","error","renderError","searchValue","page","BASE_URL","Query","params","url","axios","totalPages","hideLoadMoreButton","showEndOfCollectionMessage","showLoadMoreButton","hideEndOfCollectionMessage","array","markup","largeImageURL","webformatURL","tags","likes","views","comments","downloads","iziToast","toggleLoadMoreButtonVisibility","showLoadMoreLoader","appendImages","hideLoadMoreLoader","show","toggleLoadMoreLoaderVisibility"],"mappings":"owBAMA,SAAS,iBAAiB,mBAAoB,IAAM,CAChD,MAAMA,EAAW,SAAS,cAAc,cAAc,EAChDC,EAAY,SAAS,cAAc,YAAY,EAC/CC,EAAa,SAAS,cAAc,SAAS,EAC7CC,EAAc,SAAS,cAAc,gBAAgB,EACrDC,EAAiB,SAAS,cAAc,mBAAmB,EAC3DC,EAAqB,SAAS,cAAc,oBAAoB,EAEtEC,IAEA,MAAMC,EAAW,IAAIC,EAAe,eAAgB,CAChD,aAAc,GACtB,CAAK,EAEDR,EAAS,iBAAiB,SAAUS,CAAQ,EAE5C,IAAIC,EAAc,EACdC,EAAgB,GAEpB,eAAeF,EAAS,EAAG,CACvB,EAAE,eAAc,EAChBG,IACAF,EAAc,EACdC,EAAgBX,EAAS,cAAc,eAAe,EAAE,MAExD,GAAI,CACA,MAAMa,EAAO,MAAMC,EAAiBH,EAAeD,CAAW,EAC9DK,EAAaF,EAAK,IAAI,EACtBH,GACH,OAAQM,EAAO,CACZC,EAAYD,CAAK,CAC7B,QAAkB,CACNV,GACH,CACJ,CAED,eAAeQ,EAAiBI,EAAaC,EAAM,CAC/C,MAAMC,EAAW,2BAEXC,EAAQ,6CAAiBH,CAAW,SAASC,CAAI,GACjDG,EAAS,uEACTC,EAAMH,EAAWC,EAAQC,EAE/B,GAAI,CAEA,MAAMT,GADW,MAAMW,EAAM,IAAID,CAAG,GACd,KAE1B,GAAI,CAACV,GAAQA,EAAK,QAAU,GAAK,CAACA,EAAK,MAAQA,EAAK,KAAK,SAAW,EAChE,MAAM,IAAI,MAAM,iBAAiB,EAGrC,MAAMY,EAAa,KAAK,KAAKZ,EAAK,UAAY,EAAE,EAChD,OAAIM,GAAQM,GACRC,IACAC,MAEAC,IACAC,KAGGhB,CACV,OAAQG,EAAO,CACZ,MAAM,IAAI,MAAMA,EAAM,SAAWA,EAAM,SAAS,KAAK,QAAUA,EAAM,OAAO,CAC/E,CACL,CAEI,SAASU,GAAqB,CAC9BvB,EAAY,OAAS,EACzB,CAeI,SAASY,EAAae,EAAO,CAC7B,MAAMC,EAASD,EACV,IACD,CAAC,CACG,cAAAE,EACA,aAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACZ,IACmB;AAAA;AAAA,uBAEIN,CAAa;AAAA,wBACZC,CAAY,UAAUC,CAAI,YAAYA,CAAI;AAAA;AAAA,6DAELC,CAAK;AAAA,6DACLC,CAAK;AAAA,gEACFC,CAAQ;AAAA,iEACPC,CAAS;AAAA;AAAA;AAAA;AAAA,SAMjE,EACA,KAAK,EAAE,EAEZrC,EAAU,UAAY8B,EACtBxB,EAAS,QAAO,EAChBqB,GACC,CAED,SAASX,EAAYD,EAAO,CAC5Bf,EAAU,UAAY,GACtBsC,EAAS,KAAK,CACV,QAAS,MAAMvB,EAAM,OAAO,uBAC5B,MAAO,MACP,SAAU,WACV,SAAU,OAClB,CAAK,CACA,CAED,SAASJ,GAAa,CACtBV,EAAW,MAAM,QAAU,OAC1B,CAED,SAASI,GAAa,CACtBJ,EAAW,MAAM,QAAU,MAC1B,CAED,SAAS0B,GAAqB,CAC1BY,EAA+B,EAAI,CACtC,CAEDrC,EAAY,iBAAiB,QAAS,SAAY,CAC9CsC,IAEJ,GAAI,CACA,MAAM5B,EAAO,MAAMC,EAAiBH,EAAeD,EAAc,CAAC,EAE9DG,EAAK,YAAc,GACnBa,IACAC,MAEAe,EAAa7B,EAAK,IAAI,EACtBH,IAEP,OAAQM,EAAO,CACZC,EAAYD,CAAK,CACzB,QAAc,CACN2B,GACH,CACL,CAAC,EAEG,SAASD,EAAaZ,EAAO,CACzB,MAAMC,EAASD,EACV,IAAI,CAAC,CAAE,cAAAE,EAAe,aAAAC,EAAc,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,KACxD;AAAA;AAAA,mCAEYN,CAAa;AAAA,wCACRC,CAAY,UAAUC,CAAI,YAAYA,CAAI;AAAA;AAAA,6EAELC,CAAK;AAAA,6EACLC,CAAK;AAAA,gFACFC,CAAQ;AAAA,iFACPC,CAAS;AAAA;AAAA;AAAA;AAAA,iBAK7E,EACA,KAAK,EAAE,EAEZrC,EAAU,mBAAmB,YAAa8B,CAAM,EAChDxB,EAAS,QAAO,EAEhBoC,GACH,CAED,SAASH,EAA+BI,EAAM,CAC1CzC,EAAY,OAAS,CAACyC,CACzB,CAED,SAASH,GAAqB,CAC1BI,EAA+B,EAAI,CACtC,CAED,SAASF,GAAqB,CAC1BE,EAA+B,EAAK,CACvC,CAED,SAASA,EAA+BD,EAAM,CAC1CxC,EAAe,MAAM,QAAUwC,EAAO,QAAU,MACnD,CAED,SAASjB,GAA6B,CAClCtB,EAAmB,MAAM,QAAU,OACtC,CAED,SAASwB,GAA6B,CAClCxB,EAAmB,MAAM,QAAU,MACtC,CACL,CAAC"}